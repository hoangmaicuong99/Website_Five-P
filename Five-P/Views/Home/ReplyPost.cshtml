@using Five_P.Models;
@model List<Reply_Post>
    @{ 
        User user = (User)Session["user"];
        FivePEntities db = new FivePEntities();
    }
@foreach (var item in Model)
{
    <br />
    <div class="s-block">
        <div class="d-block p-lg-4 p-2">
            <div class="row mt-2">
                <div class="col-md-3 border-right">
                    <div class="row">
                        <a href="#" class="text-center"><i class="far fa-caret-square-up w-50 h-50"></i></a>
                        @{
                            List<Rate_Reply_Post> listRateReplyPost_T = db.Rate_Reply_Post.Where(n => n.reply_post_id == item.reply_post_id && n.rate_reply_post1 == true).ToList();
                            List<Rate_Reply_Post> listRateReplyPost_F = db.Rate_Reply_Post.Where(n => n.reply_post_id == item.reply_post_id && n.rate_reply_post1 == false).ToList();
                            int intCoutT = listRateReplyPost_T.Count();
                            int intCoutF = listRateReplyPost_F.Count();
                            int intDivided = intCoutT - intCoutF;
                        }
                        <div class="w-100 text-center mt--5"><p style="font-size:200%;color:#ff0090">@intDivided</p></div>
                        <a href="#" class="text-center"><i class="far fa-caret-square-down w-50 h-50"></i></a>
                    </div>
                    <div class="" style="color:#fc45ff;text-align:center">
                        @if (user == null)
                        {
                            <a href="#" data-toggle="modal" data-target="#modal-notification"><i class="fas fa-history" style="width:12%;height:12%"></i></a>
                        }
                        else
                        {
                            <a href="#" ><i class="fas fa-history" style="width:12%;height:12%"></i></a>
                        }
                        <!--hien thị hoạt động bài viết này-->
                    </div>
                    <!--Hiển thị thông báo-->
                    <div class="modal fade" id="modal-notification" tabindex="-1" role="dialog" aria-labelledby="modal-notification" aria-hidden="true">
                        <div class="modal-dialog modal-danger modal-dialog-centered modal-" role="document">
                            <div class="modal-content bg-gradient-danger">
                                <div class="modal-header">
                                    <h6 class="modal-title" id="modal-title-notification">Thông báo đến bạn!!</h6>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">×</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="py-3 text-center">
                                        <i class="ni ni-bell-55 ni-3x"></i>
                                        <h4 class="heading mt-4">Đăng nhập để thực hiện chức năng này.</h4>
                                        <p>Five-P cảm ơn!</p>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-white">Đăng nhập</button>
                                    <button type="button" class="btn btn-white">Đăng ký</button>
                                    <button type="button" class="btn btn-link text-white ml-auto" data-dismiss="modal">Đóng</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-9">
                    <div class="row h-auto">
                        <p>@item.reply_post_title</p>
                    </div>
                    <div class="row h-auto">
                        <p>@item.reply_post_content</p>
                    </div>
                    <div class="row h-auto">
                        <div class="col-md-7">
                            <p>Danh tiếng @item.User.user_popular</p>
                        </div>
                        <div class="col-md-5" style="">
                            <span style="float:right">Ngày @item.reply_post_datecreated.Value.Day / @item.reply_post_datecreated.Value.Month / @item.reply_post_datecreated.Value.Year</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6"></div>
                        <div class="col-md-6" style="">
                            <img src="~/Content/UI/img/faces/@item.User.user_img" alt="Rounded image" class="img-fluid rounded shadow" style="width: 50px;">
                            <span style="float:right">@item.User.user_nicename</span>
                            @{
                                if (user == null)
                                {
                                    <div><a href="@Url.Action("Index", "Home")">Đăng nhập kết bạn @{Session["NotLogin"] = "<i class='fas fa-times-circle'>&nbsp;</i> Sai tài khoản hoặc mật khẩu!";}</a></div>
                                }
                                else
                                {
                                    Friend friend = db.Friends.FirstOrDefault(n => n.user_friend_id == item.user_id && n.user_id == user.user_id);
                                    if (friend == null)
                                    {
                                        <div><a href="#">Kết bạn</a></div>
                                    }
                                    else
                                    {
                                        <div>Bạn bè</div>
                                    }
                                }
                            }
                            <div>Huy hiệu <i class="fas fa-medal" style="color:yellow"></i> 5</div>
                            <div>Huy hiệu <i class="fas fa-medal" style="color:silver"></i> 5</div>
                            <div>Huy hiệu <i class="fas fa-medal" style="color:#e88d15"></i> 5</div>
                        </div>
                    </div>
                </div>
            </div>
            <a class="badge badge-pill badge-info text-uppercase" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                Bình luận <i class="fas fa-angle-double-down"></i>
            </a>
            <div class="collapse" id="collapseExample">
                <div class="card card-body">
                    <form>
                        <textarea name="#" class="w-100"></textarea>
                        <button type="submit" class="btn btn-block btn-warning mb-3">Bình luận <i class="fas fa-comments"></i></button>
                    </form>
                    @Html.Action("Comment","CommentReplyPost", new { idReplyPost = item.reply_post_id})
                    <a class="badge badge-pill badge-info text-uppercas" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                        <i class="fas fa-angle-double-up"></i><i class="fas fa-angle-double-up"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
}
